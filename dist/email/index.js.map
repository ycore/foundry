{"version":3,"file":"index.js","sources":["../../src/email/@types/email-template-builder.ts","../../src/email/email.config.ts","../../src/email/email.context.ts","../../src/email/providers/base-provider.ts","../../src/email/providers/local-dev.ts","../../src/email/providers/mailchannels.ts","../../src/email/providers/resend.ts","../../src/email/providers/test-mock.ts","../../src/email/email-provider.ts","../../src/email/email-validator.ts","../../src/email/templates/tailwind.styles.ts","../../src/email/templates/minimal-template.tsx","../../src/email/templates/mock-template.tsx"],"sourcesContent":["import type { TailwindStylesMap } from '@ycore/componentry/email/server';\nimport type { JSXElementConstructor, ReactElement } from 'react';\n\n/**\n * Email Template Definition\n *\n * Type-safe structure for defining email templates with component, subject, and styles map\n */\nexport interface EmailTemplateDefinition<TData> {\n  component: (props: TData) => ReactElement<unknown, string | JSXElementConstructor<unknown>>;\n  subject: (data: TData) => string;\n  stylesMap?: TailwindStylesMap;\n}\n\n/**\n * Email Template Object\n *\n * Returned by defineEmailTemplate with helper methods\n */\nexport interface EmailTemplateObject<TData> {\n  component: (props: TData) => ReactElement<unknown, string | JSXElementConstructor<unknown>>;\n  subject: (data: TData) => string;\n  stylesMap?: TailwindStylesMap;\n  render: (data: TData) => {\n    component: ReactElement<unknown, string | JSXElementConstructor<unknown>>;\n    subject: string;\n    stylesMap?: TailwindStylesMap;\n  };\n}\n\n/**\n * Define Email Template\n *\n * Type-safe helper for creating unified email templates\n *\n * @example\n * ```typescript\n * export const ContactTemplate = defineEmailTemplate({\n *   component: ({ name, email }) => <Html>...</Html>,\n *   subject: ({ name }) => `Contact from ${name}`,\n *   stylesMap: TEMPLATE_TAILWIND_MAP,\n * });\n * ```\n */\nexport function defineEmailTemplate<TData>({ component, subject, stylesMap }: EmailTemplateDefinition<TData>): EmailTemplateObject<TData> {\n  return {\n    component,\n    subject,\n    stylesMap,\n    // Helper method for type-safe rendering\n    render: (data: TData) => ({\n      component: component(data),\n      subject: subject(data),\n      stylesMap,\n    }),\n  };\n}\n","import type { EmailConfig } from './@types/email.types';\n\n/**\n * Default Email Configuration\n *\n * IMPORTANT: This configuration uses local-dev provider by default for development.\n * For production deployments, you MUST:\n * 1. Override this config in your app's config file (e.g., app/config/config.system.ts)\n * 2. Set active provider to 'resend' or 'mailchannels'\n * 3. Configure valid sendFrom addresses for your domain\n * 4. Set API keys via environment variables or Cloudflare bindings\n *\n */\nexport const defaultEmailConfig: EmailConfig = {\n  active: 'local-dev',\n  providers: [\n    {\n      name: 'local-dev',\n      sendFrom: 'dev@localhost',\n    },\n  ],\n};\n","import { createContextSingleton } from '@ycore/forge/context';\nimport type { EmailConfig } from './@types/email.types';\n\n/**\n * Email configuration context for React Router - singleton pattern to prevent context duplication\n */\nexport const emailContext = createContextSingleton<EmailConfig | null>('EmailContext', null);\n","import { logger } from '@ycore/forge/logger';\nimport type { Result } from '@ycore/forge/result';\nimport { err, tryCatch } from '@ycore/forge/result';\nimport type { EmailProvider, SendEmailOptions } from '../@types/email.types';\n\n/**\n * Configuration delays for email providers (in milliseconds)\n */\nexport const EMAIL_PROVIDER_DELAYS = {\n  LOCAL_DEV: 800,\n  TEST_MOCK: 10,\n} as const;\n\n/**\n * Base email provider factory - creates an EmailProvider with common validation and error handling logic\n */\nexport function createEmailProviderBase(name: string, sendFn: (options: SendEmailOptions) => Promise<void>): EmailProvider {\n  return {\n    async sendEmail(options: SendEmailOptions): Promise<Result<void>> {\n      const { from, to, template } = options;\n\n      if (!from) {\n        return err('From address is required');\n      }\n\n      return tryCatch(async () => {\n        await sendFn(options);\n\n        logger.debug('email_sent_success', {\n          provider: name,\n          to,\n          subject: template.subject,\n        });\n      }, `Failed to send email via ${name}`);\n    },\n  };\n}\n","import { logger } from '@ycore/forge/logger';\nimport type { EmailProvider } from '../@types/email.types';\nimport { createEmailProviderBase, EMAIL_PROVIDER_DELAYS } from './base-provider';\n\n/**\n * Local Dev Email Provider - Development provider that logs emails instead of sending\n */\nexport function createLocalDevEmailProvider(): EmailProvider {\n  return createEmailProviderBase('local-dev', async options => {\n    const { to, from, template } = options;\n    // Simulate a slight delay like a real email service\n    await new Promise(resolve => setTimeout(resolve, EMAIL_PROVIDER_DELAYS.LOCAL_DEV));\n    // Log email metadata using structured logging\n    logger.info('local_dev_email_sent', { provider: 'local-dev', from, to, subject: template.subject });\n    // Display email content with proper line breaks (console.log for readability in dev)\n    console.log(' === Message content (plain text)', '='.repeat(48), '\\n', template.text, '\\n', '='.repeat(80));\n  });\n}\n","import type { EmailProvider } from '../@types/email.types';\nimport { createEmailProviderBase } from './base-provider';\n\n/**\n * MailChannels Email Provider\n * Implementation for MailChannels email service\n *\n * Requires DNS record for authorization:\n * Type: TXT, Name: _mailchannels, Content: \"v=mc1 auth=<AccountId>\"\n */\nexport function createMailChannelsEmailProvider(): EmailProvider {\n  const apiUrl = 'https://api.mailchannels.net/tx/v1/send';\n\n  return createEmailProviderBase('mailchannels', async options => {\n    const { apiKey, to, from, template } = options;\n\n    const payload = {\n      personalizations: [\n        {\n          to: [{ email: to }],\n        },\n      ],\n      from: { email: from },\n      subject: template.subject,\n      content: [\n        { type: 'text/plain', value: template.text },\n        { type: 'text/html', value: template.html },\n      ],\n    };\n\n    const response = await fetch(apiUrl, {\n      method: 'POST',\n      headers: {\n        'X-Api-Key': apiKey,\n        'Content-Type': 'application/json',\n        Accept: 'application/json',\n      },\n      body: JSON.stringify(payload),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`MailChannels API error (${response.status}): ${errorText}`);\n    }\n  });\n}\n","import type { EmailProvider } from '../@types/email.types';\nimport { createEmailProviderBase } from './base-provider';\n\n/**\n * Resend Email Provider\n * Implementation for Resend email service (https://resend.com)\n */\nexport function createResendEmailProvider(): EmailProvider {\n  return createEmailProviderBase('resend', async options => {\n    const { apiKey, to, from, template } = options;\n\n    const response = await fetch('https://api.resend.com/emails', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${apiKey}`,\n      },\n      body: JSON.stringify({\n        from,\n        to,\n        subject: template.subject,\n        html: template.html,\n        text: template.text,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorText = await response.text();\n      throw new Error(`Resend API error (${response.status}): ${errorText}`);\n    }\n  });\n}\n","import { logger } from '@ycore/forge/logger';\nimport { err } from '@ycore/forge/result';\nimport type { EmailProvider } from '../@types/email.types';\nimport { createEmailProviderBase, EMAIL_PROVIDER_DELAYS } from './base-provider';\n\n/**\n * Stored email metadata for test verification (excludes sensitive data)\n */\nexport interface StoredTestEmail {\n  to: string;\n  from: string;\n  template: {\n    subject: string;\n    html: string;\n    text: string;\n  };\n}\n\n/**\n * Module-level state for test email tracking\n * Isolated from production code for security\n */\nlet sentEmails: StoredTestEmail[] = [];\nlet shouldFail = false;\nlet failureReason = 'Simulated email failure';\n\n/**\n * Test Mock Email Provider\n * Enhanced mock provider for testing that tracks sent emails and allows failure simulation\n */\nexport function createTestMockEmailProvider(): EmailProvider {\n  return {\n    async sendEmail(options) {\n      const { to, from, template } = options;\n\n      if (!from) {\n        return err('From address is required');\n      }\n\n      // Store email metadata for test verification (excludes sensitive apiKey)\n      sentEmails.push({\n        to,\n        from,\n        template: {\n          subject: template.subject,\n          html: template.html,\n          text: template.text,\n        },\n      });\n\n      // Simulate failure if configured\n      if (shouldFail) {\n        return err(failureReason);\n      }\n\n      // Use base provider for consistent behavior\n      const baseProvider = createEmailProviderBase('test-mock', async opts => {\n        await new Promise(resolve => setTimeout(resolve, EMAIL_PROVIDER_DELAYS.TEST_MOCK));\n\n        logger.debug('email_test_mock_sent', {\n          provider: 'test-mock',\n          from: opts.from,\n          to: opts.to,\n          subject: opts.template.subject,\n          textLength: opts.template.text.length,\n          htmlLength: opts.template.html.length,\n        });\n      });\n\n      return baseProvider.sendEmail(options);\n    },\n  };\n}\n\n// ============================================================================\n// Test Utility Functions\n// ============================================================================\n\n/**\n * Get all sent emails (returns copy to prevent mutation)\n */\nexport function getTestSentEmails(): StoredTestEmail[] {\n  return sentEmails.map(email => ({\n    to: email.to,\n    from: email.from,\n    template: {\n      subject: email.template.subject,\n      html: email.template.html,\n      text: email.template.text,\n    },\n  }));\n}\n\n/**\n * Get the most recently sent email\n */\nexport function getTestLastSentEmail(): StoredTestEmail | undefined {\n  const lastEmail = sentEmails[sentEmails.length - 1];\n  if (!lastEmail) {\n    return undefined;\n  }\n\n  return {\n    to: lastEmail.to,\n    from: lastEmail.from,\n    template: {\n      subject: lastEmail.template.subject,\n      html: lastEmail.template.html,\n      text: lastEmail.template.text,\n    },\n  };\n}\n\n/**\n * Get count of sent emails\n */\nexport function getTestEmailCount(): number {\n  return sentEmails.length;\n}\n\n/**\n * Find email sent to specific recipient\n */\nexport function findTestEmailByTo(to: string): StoredTestEmail | undefined {\n  return sentEmails.find(email => email.to === to);\n}\n\n/**\n * Find all emails with subject containing search string\n */\nexport function findTestEmailsBySubject(subject: string): StoredTestEmail[] {\n  return sentEmails.filter(email => email.template.subject.includes(subject));\n}\n\n/**\n * Clear all sent emails\n */\nexport function clearTestSentEmails(): void {\n  sentEmails = [];\n}\n\n/**\n * Configure provider to simulate failures\n */\nexport function simulateTestEmailFailure(reason = 'Simulated email failure'): void {\n  shouldFail = true;\n  failureReason = reason;\n}\n\n/**\n * Reset provider to success mode\n */\nexport function resetTestEmailToSuccess(): void {\n  shouldFail = false;\n  failureReason = 'Simulated email failure';\n}\n\n/**\n * Full reset - clears emails and resets failure state\n */\nexport function resetTestEmailProvider(): void {\n  clearTestSentEmails();\n  resetTestEmailToSuccess();\n}\n\n/**\n * Get current failure configuration\n */\nexport function getTestEmailFailureState(): { shouldFail: boolean; reason: string } {\n  return {\n    shouldFail,\n    reason: failureReason,\n  };\n}\n\n// ============================================================================\n// Test Assertion Helpers\n// ============================================================================\n\n/**\n * Assert that an email was sent to a specific recipient\n * Throws if email not found\n */\nexport function assertTestEmailSent(to: string): StoredTestEmail {\n  const email = findTestEmailByTo(to);\n  if (!email) {\n    throw new Error(`Expected email to be sent to ${to}, but no email was found`);\n  }\n  return email;\n}\n\n/**\n * Assert specific number of emails were sent\n */\nexport function assertTestEmailCount(expectedCount: number): void {\n  const actualCount = getTestEmailCount();\n  if (actualCount !== expectedCount) {\n    throw new Error(`Expected ${expectedCount} emails to be sent, but ${actualCount} were sent`);\n  }\n}\n\n/**\n * Assert no emails were sent\n */\nexport function assertTestNoEmailsSent(): void {\n  assertTestEmailCount(0);\n}\n","import type { Result } from '@ycore/forge/result';\nimport { err, ok } from '@ycore/forge/result';\nimport type { EmailConfig, EmailProvider, EmailProviderConfig, EmailProviders } from './@types/email.types';\nimport { createLocalDevEmailProvider } from './providers/local-dev';\nimport { createMailChannelsEmailProvider } from './providers/mailchannels';\nimport { createResendEmailProvider } from './providers/resend';\nimport { createTestMockEmailProvider } from './providers/test-mock';\n\nconst providerRegistry: Record<EmailProviders, () => EmailProvider> = {\n  'local-dev': createLocalDevEmailProvider,\n  mailchannels: createMailChannelsEmailProvider,\n  resend: createResendEmailProvider,\n  'test-mock': createTestMockEmailProvider,\n};\n\nexport function createEmailProvider(providerName: string): Result<EmailProvider> {\n  if (!isValidProvider(providerName)) {\n    return err(`Unsupported email provider: ${providerName}`);\n  }\n\n  try {\n    const factory = providerRegistry[providerName];\n    const provider = factory();\n    return ok(provider);\n  } catch (error) {\n    return err(`Failed to create email provider: ${providerName}`, undefined, { cause: error });\n  }\n}\n\nexport function isValidProvider(providerName: string): providerName is EmailProviders {\n  return providerName in providerRegistry;\n}\n\nexport function getSupportedProviders(): EmailProviders[] {\n  return Object.keys(providerRegistry) as EmailProviders[];\n}\n\nexport function getEmailProviderNames(emailConfig: EmailConfig): EmailProviders[] {\n  return emailConfig.providers.map(provider => provider.name);\n}\n\nexport function getProviderConfig(emailConfig: EmailConfig, providerName: string): EmailProviderConfig | undefined {\n  return emailConfig.providers.find(provider => provider.name === providerName);\n}\n","import * as v from 'valibot';\n\nexport const EmailSchema = v.pipe(v.string(), v.trim(), v.toLowerCase(), v.email(), v.maxLength(254));\n\nexport type ValidEmail = v.InferOutput<typeof EmailSchema>;\n","/**\n * ⚠️  DO NOT EDIT THIS FILE MANUALLY\n * Auto-generated Tailwind CSS utility styles map for email components at: 2025-11-03T16:38:05.887Z\n *\n *   - Template files scanned: 2\n *   - Unique classes found: 23\n *   - Static styles mapped: 24\n *   - Dynamic patterns: 0\n */\n\nimport type { TailwindStylesMap } from '@ycore/componentry/email/server';\nimport type { CSSProperties } from 'react';\n\nexport const TAILWIND_TO_CSS_MAP: Record<string, Partial<CSSProperties>> = {\n  'mx-auto': {\"marginInline\":\"auto\"},\n  'my-5': {\"marginBlock\":\"1.25rem\"},\n  'max-w-2xl': {\"maxWidth\":\"42rem\"},\n  'rounded': {\"borderRadius\":\"0.25rem\"},\n  'border-b': {\"borderBottomStyle\":\"solid\",\"borderBottomWidth\":\"1px\"},\n  'border-l-4': {\"borderLeftStyle\":\"solid\",\"borderLeftWidth\":\"4px\"},\n  'border-blue-500': {\"borderColor\":\"oklch(62.3% 0.214 259.815)\"},\n  'border-border': {\"borderColor\":\"oklch(70.7% 0.022 261.325)\"},\n  'bg-muted': {\"backgroundColor\":\"oklch(87.2% 0.01 258.338)\"},\n  'bg-white': {\"backgroundColor\":\"#fff\"},\n  'p-4': {\"padding\":\"1rem\"},\n  'p-5': {\"padding\":\"1.25rem\"},\n  'px-5': {\"paddingInline\":\"1.25rem\"},\n  'py-5': {\"paddingBlock\":\"1.25rem\"},\n  'py-8': {\"paddingBlock\":\"2rem\"},\n  'pt-10': {\"paddingTop\":\"2.5rem\"},\n  'pb-5': {\"paddingBottom\":\"1.25rem\"},\n  'text-center': {\"textAlign\":\"center\"},\n  'font-sans': {\"fontFamily\":\"ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',\\n    'Noto Color Emoji'\"},\n  'text-sm': {\"fontSize\":\"0.875rem\",\"lineHeight\":\"var(--text-sm--line-height)\"},\n  'text-foreground': {\"color\":\"oklch(27.8% 0.033 256.848)\"},\n  'text-gray-900': {\"color\":\"oklch(21% 0.034 264.665)\"},\n  'text-muted-foreground': {\"color\":\"oklch(55.1% 0.027 264.364)\"},\n  'dark': {\"color\":\"color-mix(in lab, red, red)) {\\n    & {\\n      --border: color-mix(in oklab, oklch(96.7% 0.003 264.542) 10%, transparent)\"},\n};\n\nexport const DYNAMIC_UTILITY_PATTERNS = [\n  // No dynamic patterns detected\n];\n\nexport const TEMPLATE_STYLES_MAP: TailwindStylesMap = {\n  cssMap: TAILWIND_TO_CSS_MAP,\n  dynamicPatterns: DYNAMIC_UTILITY_PATTERNS,\n};\n","import { Body, Container, Head, Html, Section, Text } from '@ycore/componentry/email';\nimport { defineEmailTemplate } from '../@types/email-template-builder';\nimport { TEMPLATE_STYLES_MAP } from './tailwind.styles';\n\nexport interface MinimalEmailData {\n  subject: string;\n  message: string;\n}\n\n/**\n * Minimal Email Template\n */\nexport const MinimalEmailTemplate = defineEmailTemplate({\n  component: ({ message }: MinimalEmailData) => (\n    <Html lang=\"en\">\n      <Head />\n      <Body className=\"bg-white font-sans\">\n        <Container className=\"mx-auto max-w-2xl\">\n          <Section className=\"p-4\">\n            <Text className=\"text-gray-900\">{message}</Text>\n          </Section>\n        </Container>\n      </Body>\n    </Html>\n  ),\n\n  subject: ({ subject }) => subject,\n\n  stylesMap: TEMPLATE_STYLES_MAP,\n});\n","import { Body, Container, Head, Heading, Hr, Html, Section, Text } from '@ycore/componentry/email';\nimport { defineEmailTemplate } from '../@types/email-template-builder';\nimport { TEMPLATE_STYLES_MAP } from './tailwind.styles';\n\nexport interface MockEmailData {\n  subject: string;\n  message: string;\n  recipientName?: string;\n}\n\n/**\n * Mock Email Template\n * Generic template for demonstration and testing purposes\n */\nexport const MockEmailTemplate = defineEmailTemplate({\n  component: ({ subject, message, recipientName = 'there' }: MockEmailData) => (\n    <Html lang=\"en\">\n      <Head />\n      <Body className=\"bg-white font-sans\">\n        <Container className=\"mx-auto max-w-2xl text-foreground\">\n          <Section className=\"border-border border-b px-5 pt-10 pb-5 text-center\">\n            <Heading level={1}>{subject}</Heading>\n          </Section>\n\n          <Section className=\"px-5 py-8\">\n            <Text>Hello {recipientName},</Text>\n\n            <Section className=\"my-5 rounded border-blue-500 border-l-4 bg-muted p-5 text-foreground\">\n              <Text>{message}</Text>\n            </Section>\n\n            <Text>Thank you for testing the Foundry email system!</Text>\n          </Section>\n\n          <Hr className=\"my-5 border-border\" />\n\n          <Section className=\"px-5 py-5 text-center text-muted-foreground text-sm\">\n            <Text>This is a test email sent from the Foundry system.</Text>\n            <Text>If you received this email by mistake, please ignore it.</Text>\n          </Section>\n        </Container>\n      </Body>\n    </Html>\n  ),\n\n  subject: ({ subject }) => subject,\n\n  stylesMap: TEMPLATE_STYLES_MAP,\n});\n"],"names":[],"mappings":"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"}