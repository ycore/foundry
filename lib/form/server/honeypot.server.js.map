{"version":3,"file":"honeypot.server.js","sourceRoot":"","sources":["../../../../src/form/server/honeypot.server.ts"],"names":[],"mappings":"AACA,OAAO,EAAE,QAAQ,EAAE,SAAS,EAAE,MAAM,6BAA6B,CAAC;AAElE,OAAO,EAAE,UAAU,EAAE,MAAM,8BAA8B,CAAC;AAE1D,MAAM,UAAU,cAAc,CAAC,OAAuB;IACpD,OAAO,IAAI,QAAQ,CAAC;QAClB,kBAAkB,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC,WAAW,KAAK,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,SAAS;QACpF,cAAc,EAAE,UAAU,CAAC,OAAO,CAAC,CAAC,mBAAmB;KACxD,CAAC,CAAC;AACL,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,aAAa,CAAC,OAAuB,EAAE,QAAkB;IAC7E,MAAM,QAAQ,GAAG,cAAc,CAAC,OAAO,CAAC,CAAC;IACzC,IAAI,CAAC;QACH,QAAQ,CAAC,KAAK,CAAC,QAAQ,CAAC,CAAC;IAC3B,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,IAAI,KAAK,YAAY,SAAS,EAAE,CAAC;YAC/B,MAAM,IAAI,QAAQ,CAAC,qBAAqB,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,CAAC,CAAC;QAC7D,CAAC;QACD,MAAM,KAAK,CAAC;IACd,CAAC;AACH,CAAC","sourcesContent":["import type { AppLoadContext } from 'react-router';\nimport { Honeypot, SpamError } from 'remix-utils/honeypot/server';\n\nimport { contextEnv } from '../../common/services/env.js';\n\nexport function createHoneypot(context: AppLoadContext) {\n  return new Honeypot({\n    validFromFieldName: contextEnv(context).ENVIRONMENT === 'testing' ? null : undefined,\n    encryptionSeed: contextEnv(context).HONEYPOT_SECRET_KEY,\n  });\n}\n\nexport async function checkHoneypot(context: AppLoadContext, formData: FormData) {\n  const honeypot = createHoneypot(context);\n  try {\n    honeypot.check(formData);\n  } catch (error) {\n    if (error instanceof SpamError) {\n      throw new Response('Form submit failure', { status: 400 });\n    }\n    throw error;\n  }\n}\n"]}